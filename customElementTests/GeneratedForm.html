<html>

<head>
    <style>
        html,
        body {
            padding: 0;
            margin: 0;
        }
    </style>
</head>

<body>
    <script type="module">
        import "../tools/GeneratedForm.js";
        import "../tools/UIWindow.js";
        import "../tools/InfiniteList.js";
        import BaseElement from "../tools/BaseElement.js";
        import { html } from "../src/lit-html/lit-html.js";

        const style = html`
            :host {
                display: block;
            }
        `;

        const items = [];

        for (let x = 0 ; x < 1000; x++){
            items.push(`Name ${x}`);
        }

        class Test extends BaseElement {
            constructor() {
                super();
                this.onPush = this.onPush.bind(this);
                this.getElement = this.getElement.bind(this);

                this.schema = {
                    "$id": "bitmap",
                    "title": "Bitmap",
                    "description": "Bitmap",
                    "type": "object",
                    "properties": {
                        "identity": {
                            "type": "string",
                            "description": ""
                        },
                        "opacity": {
                            "type": "range",
                            "minimum": 0,
                            "maximum": 1
                        },
                        "isDirty": {
                            "type": "boolean"
                        },
                        "zIndex": {
                            "type": "integer"
                        },
                        "textarea":{
                            "type": "textarea"
                        }
                    }
                };
            }

            getElement(item){
                return html`
                    <div @click=${this.onPush} style="height: 50xp; line-height: 50px;">${item}</div>
                `;
            }

            onPush(event) {
                const customEvent = new CustomEvent("push", {
                    bubbles: true,
                    composed: true,
                    cancelable: false,
                    detail: {
                        title: "More Content",
                        content: html`
                            <infinite-list style="height:100%;width:100%;" .getElement=${this.getElement} .elementHeight=${50} .items=${items} ></infinite-list>
                        `
                    }
                });

                event.target.dispatchEvent(customEvent);
            }

            render() {
                return html`
                    <ui-window title="Name" style="width:300px;height:500px;">
                        <div style="height:100%;width:100%;overflow: auto;">
                            <generated-form .schema=${this.schema}></generated-form>
                            <button @click=${this.onPush}>Push</button>
                        </div>
                    </ui-window>
                `;
            }
        }

        customElements.define("ui-test", Test);
    </script>

    <ui-test></ui-test>
</body>

</html>